targets:
  main:
    resources:
      RemotePlace:
        name: !template "$LG_PLACE"
    drivers:
      TFTPProviderDriver: {}
      SerialDriver:
        txdelay: 0.05
      power_driver:
        cls: GpioDigitalOutputDriver
        name: power_driver
        bindings:
          gpio: power
      reset_driver:
        cls: GpioDigitalOutputDriver
        name: reset_driver
        bindings:
          gpio: reset
      DigitalOutputPowerDriver:
        bindings:
          output: power_driver
      ShellDriver:
        prompt: 'root@[\w()]+:[^ ]+ '
        login_prompt: Please press Enter to activate this console.
        await_login_timeout: 15
        login_timeout: 120
        post_login_settle_time: 5
        username: root
      SmallUBootDriver:
        boot_expression: "Autobooting in 1 seconds"
        prompt: "ap135>"
        boot_secret: "tpl"
        init_commands:
          - setenv ipaddr 192.168.1.200
          - setenv serverip 192.168.1.99
          - tftp 0x82000000 tplink_tl-wr1043nd-v3/openwrt-24.10.2-ath79-generic-tplink_tl-wr1043nd-v3-initramfs-kernel.bin
      UBootTFTPStrategy: {}
      SSHDriver: {}

images:
  root: !template $LG_IMAGE

imports:
  - ../strategies/tftpstrategy.py
